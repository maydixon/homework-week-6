
 p1 <- mean(v)
 #one sample formula
p1
p0 <- 0.8
n1 <- 30
z <- (p1 - p0)/sqrt(p0 * (1 - p0)/n1)
p <- pnorm(z, lower.tail = TRUE)
p

#two sample formula
pstar <- (p1+p2)/2

z <- (p2 - p1)/sqrt((pstar * (1 - pstar)) * (1/n1 + 1/n2))
z

p <- 1 - pnorm(z, lower.tail = TRUE) + pnorm(z, lower.tail = FALSE)
p
```{r}
Z.prop.test <- function(p1, n1, p0, p2=NULL, n2=NULL, alternative="two.sided", conf.level=0.95){

if (p2== NULL | n2==NULL){
       z <- (p1 - p0)/sqrt(p0 * (1 - p0)/n1)
            z
            
      if (alternative == "less"){
           
            p <- pnorm(z, lower.tail = TRUE)
            p
      }
      if (alternative == "greater"){
            
            p <- pnorm(z, lower.tail = FALSE)
            p
      }
      if (alternative == "two.tailed"){
           
            p <- 2*pnorm(z)
            p
      }
}
      
if (p2 !=NULL & n2 != NULL){
     
      pstar <- (p1+p2)/2
      z <- (p1 - p2)/sqrt((pstar * (1 - pstar)) * (1/n1 + 1/n2))
      
      if (alternative=="two.tailed"){
            
            p <- 1 - pnorm(z, lower.tail = TRUE) + pnorm(z, lower.tail = FALSE)
            p
      
      }
      
      if (alternative=="greater"){
            
            p <- pnorm(z, lower.tail = FALSE)
            p
      
      }
      if (alternative == "less"){
           
            p <- pnorm(z, lower.tail = TRUE)
            p
      }
}
}
